<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.tsingshan.infomana.mapper.PassportInfoVoMapper">

	
	<sql id="selectPassportInfoVo">
        SELECT
            p.id,
            p.employee_id,
            p.passport_no,
            e.employee_name,
            e.identity_card,
            e.employee_no,
            p.passport_issue_date,
            p.passport_deadline,
            p.state,
            p.del_flag,
            p.remark
        FROM
            ros_passport_info p
        LEFT JOIN employee e ON p.employee_id = e.employee_id
        WHERE
            p.del_flag = '0'
    </sql>
	
    <select id="selectPassportInfoVoList" parameterType="com.tsingshan.infomana.domain.vo.PassportInfoVo" resultType="com.tsingshan.infomana.domain.vo.PassportInfoVo">
        <include refid="selectPassportInfoVo"/>
        <where>
            <if test="id != null "> and p.id = #{id}</if>
             <if test="passportNo != null  and passportNo != '' "> and p.passport_no = #{passportNo}</if>
            <if test="employeeId != null "> and e.employee_id = #{employeeId}</if>
            <if test="employeeName != null  and employeeName != '' "> and e.employee_name = #{employeeName}</if>
            <if test="identityCard != null  and identityCard != '' "> and e.identity_card = #{identityCard}</if>
            <if test="employeeNo != null  and employeeNo != '' "> and e.employee_no = #{employeeNo}</if>
            <if test="passportIssueDate != null "> and p.passport_issue_date = #{passportIssueDate}</if>
            <if test="passportDeadline != null "> and p.passport_deadline = #{passportDeadline}</if>
             <if test="state != null  and state != '' "> and p.state = #{state}</if>
             <if test="remark != null  and remark != '' "> and remark = #{remark}</if>
         </where>
    </select>
    
    <select id="selectPassportInfoVoById" parameterType="Long" resultType="com.tsingshan.infomana.domain.vo.PassportInfoVo">
        <include refid="selectPassportInfoVo"/>
        and p.id = #{id}
    </select>


	<select id="exportPassportInfoVo" parameterType="Long" resultType="com.tsingshan.infomana.domain.vo.PassportInfoVo">
        SELECT
            p.passport_no,
            e.employee_name,
            e.identity_card,
            e.employee_no,
            p.passport_issue_date,
            p.passport_deadline,
            -- p.state,
            (
              SELECT
                f.dict_label
              FROM
                sys_dict_data f
              WHERE
                f.dict_type = 'roster_passport_state'
              AND f.dict_value = p.state
            ) state,
            p.del_flag,
            p.remark
        FROM
            ros_passport_info p
        LEFT JOIN employee e ON p.employee_id = e.employee_id
        WHERE
            p.del_flag = '0' and p.id in
        <foreach collection="ids" item="ids" open="(" separator="," close=")">
            ${ids}
        </foreach>
    </select>
    <!--
    <delete id="deletePassportInfoByIds" parameterType="Long">
        delete from ros_passport_info where id in 
        <foreach item="id" collection="array" open="(" separator="," close=")">
            #{id}
        </foreach>
    </delete>-->
    
</mapper>